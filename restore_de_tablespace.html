<!doctype html>
<html lang="es">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>RESTORE DE TABLESPACE | ADMINISTRACIÓN DE BASES DE DATOS </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta name="author" content="Jorge Iván Bedoya Restrepo" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-sa/4.0/" />
<meta name="generator" content="eXeLearning 2.5 - exelearning.net" />
<!--[if lt IE 9]><script type="text/javascript" src="exe_html5.js"></script><![endif]-->
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body class="exe-web-site" id="exe-node-53"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Saltar la navegación</a></p>
<header id="header" ><div id="headerContent">ADMINISTRACIÓN DE BASES DE DATOS</div></header>
<nav id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">ADMINISTRACIÓN DE BASES DE DATOS</a></li>
   <li><a href="rol_del_dba.html" class="no-ch">ROL DEL DBA</a></li>
   <li><a href="generalidades_de_oracle.html" class="daddy">GENERALIDADES DE ORACLE</a>
   <ul class="other-section">
      <li><a href="un_poco_de_historia.html" class="no-ch">UN POCO DE HISTORIA</a></li>
      <li><a href="pl__sql.html" class="no-ch">PL / SQL</a></li>
      <li><a href="ambientes_de_trabajo.html" class="daddy">AMBIENTES DE TRABAJO</a>
      <ul class="other-section">
         <li><a href="sql_plus.html" class="no-ch">SQL PLUS</a></li>
         <li><a href="sql_developer.html" class="no-ch">SQL DEVELOPER</a></li>
         <li><a href="otros_ambientes.html" class="no-ch">OTROS AMBIENTES</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="arquitectura_de_oracle.html" class="daddy">ARQUITECTURA DE ORACLE</a>
   <ul class="other-section">
      <li><a href="manejo_de_memoria.html" class="no-ch">MANEJO DE MEMORIA</a></li>
      <li><a href="manejo_de_procesos.html" class="no-ch">MANEJO DE PROCESOS</a></li>
      <li><a href="arquitectura_multitenant.html" class="no-ch">ARQUITECTURA MULTITENANT</a></li>
   </ul>
   </li>
   <li><a href="instrucciones_varias_de_oracle.html" class="no-ch">INSTRUCCIONES VARIAS DE ORACLE</a></li>
   <li><a href="vistas.html" class="daddy">VISTAS</a>
   <ul class="other-section">
      <li><a href="vistas_comunes.html" class="no-ch">VISTAS COMUNES</a></li>
      <li><a href="vistas_materializables.html" class="no-ch">VISTAS MATERIALIZABLES</a></li>
   </ul>
   </li>
   <li><a href="secuencias.html" class="no-ch">SECUENCIAS</a></li>
   <li><a href="migracin_de_datos.html" class="daddy">MIGRACIÓN DE DATOS</a>
   <ul class="other-section">
      <li><a href="insert_all.html" class="no-ch">INSERT ALL</a></li>
      <li><a href="insert_first__pivote.html" class="no-ch">INSERT FIRST - PIVOTE</a></li>
      <li><a href="merge.html" class="no-ch">MERGE</a></li>
   </ul>
   </li>
   <li><a href="manejo_de_ndices.html" class="no-ch">MANEJO DE ÍNDICES</a></li>
   <li><a href="manejo_de_usuarios.html" class="daddy">MANEJO DE USUARIOS</a>
   <ul class="other-section">
      <li><a href="usuarios_y_privilegios.html" class="no-ch">USUARIOS Y PRIVILEGIOS</a></li>
      <li><a href="roles.html" class="no-ch">ROLES</a></li>
      <li><a href="perfiles.html" class="no-ch">PERFILES</a></li>
   </ul>
   </li>
   <li><a href="diccionario_de_datos.html" class="daddy">DICCIONARIO DE DATOS</a>
   <ul class="other-section">
      <li><a href="ejercicio_completo.html" class="no-ch">EJERCICIO COMPLETO</a></li>
      <li><a href="consultas_tiles_para_el_dba.html" class="no-ch">CONSULTAS ÚTILES PARA EL DBA</a></li>
   </ul>
   </li>
   <li><a href="optimizacin_de_consultas.html" class="no-ch">OPTIMIZACIÓN DE CONSULTAS</a></li>
   <li><a href="buenas_prcticas_en_sql.html" class="no-ch">BUENAS PRÁCTICAS EN SQL</a></li>
   <li><a href="backups.html" class="daddy">BACKUPS</a>
   <ul class="other-section">
      <li><a href="undo_redologs_y_archivelogs.html" class="no-ch">UNDO, REDOLOGS y ARCHIVELOGS</a></li>
      <li><a href="rman.html" class="no-ch">RMAN</a></li>
      <li><a href="backup_completo.html" class="no-ch">BACKUP COMPLETO</a></li>
      <li><a href="backup_tablespaces.html" class="no-ch">BACKUP TABLESPACES</a></li>
      <li><a href="backup_controlfile.html" class="no-ch">BACKUP CONTROLFILE</a></li>
      <li><a href="backup_archivelog.html" class="no-ch">BACKUP ARCHIVELOG</a></li>
      <li><a href="backup_incremental.html" class="no-ch">BACKUP INCREMENTAL</a></li>
   </ul>
   </li>
   <li class="current-page-parent"><a href="restores.html" class="current-page-parent daddy">RESTORES</a>
   <ul>
      <li><a href="introduccion.html" class="no-ch">INTRODUCCION</a></li>
      <li><a href="restore_base_de_datos_completa.html" class="no-ch">RESTORE BASE DE DATOS COMPLETA</a></li>
      <li id="active"><a href="restore_de_tablespace.html" class="active no-ch">RESTORE DE TABLESPACE</a></li>
      <li><a href="restore_hasta_un_tiempo_t.html" class="no-ch">RESTORE HASTA UN TIEMPO t</a></li>
   </ul>
   </li>
   <li><a href="encriptacin_de_datos.html" class="no-ch">ENCRIPTACIÓN DE DATOS</a></li>
   <li><a href="flashback.html" class="no-ch">FLASHBACK</a></li>
   <li><a href="auditoria.html" class="no-ch">AUDITORIA</a></li>
   <li><a href="gestin_de_lobs.html" class="no-ch">GESTIÓN DE LOBs</a></li>
   <li><a href="tablas_particionadas.html" class="no-ch">TABLAS PARTICIONADAS</a></li>
   <li><a href="gestin_de_almacenamiento.html" class="no-ch">GESTIÓN DE ALMACENAMIENTO</a></li>
</ul>
</nav>
<div id='topPagination'>
<nav class="pagination noprt">
<a href="restore_base_de_datos_completa.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="restore_hasta_un_tiempo_t.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</nav>
</div>
<div id="main-wrapper">
<section id="main">
<header id="nodeDecoration"><h1 id="nodeTitle">RESTORE DE TABLESPACE</h1></header>
<article class="iDevice_wrapper textIdevice" id="id46">
<div class="iDevice emphasis0" >
<div id="ta46_108_2" class="block iDevice_content">
<div class="exe-text"><p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">Si el tablespace que vamos a restaurar es alguno de los del sistema, SYSTEM, SYSAUX, UNDO, etc., debo hacer la restauración en frío, y en modo STARTUP NOMOUNT. Si es un tablespace de datos, lo puedo hacer en caliente.</span></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">Para hacer el ejercicio, miremos los tablespaces existentes.</span></p>
<p><img src="img0.11.png" width="1033" height="269" alt="MMM" /></p>
<p><span style="font-family: verdana, geneva, sans-serif;">Podemos observar que hay un tablespace llamado DATOS.</span></p>
<p><span style="font-family: verdana, geneva, sans-serif;">Primero hagamos un backup del tablespace con el cual vamos a hacer el ejercicio, DATOS.</span></p>
<p><img src="img1.10.png" width="1069" height="45" alt="MM" /></p>
<p><span style="font-family: verdana, geneva, sans-serif;">Ahora, conectémonos con el usuario de trabajo a SQL Plus y hagamos algo en el tablespace.</span></p>
<p><img src="img2.10.png" width="698" height="429" alt="BB" /></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">Lo anterior no quedó en el backup que hicimos del tablespace.</span></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">Vamos a simular un daño en el tablespace, borrando su correspondiente Data File. Vamos a Windows y lo borramos. En este caso, borramos DATOS.DBF.</span></p>
<p><img src="img3.10.png" width="667" height="459" alt="mmm" /></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">Tarde que temprano, vamos a obtener un error, generalmente es el error de end of channel. Miremos el archivo de trace y detectamos que el problema es con el archivo que hemos borrado.</span></p>
<p><img src="img4.10.png" width="988" height="228" alt="MMM" /></p>
<p><img src="img5.7.png" width="1069" height="181" alt="MMMM" /></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">Luego de hacer un SHUTDOWN ABORT, tratemos de abrir la base de datos con el comando siguiente. Obviamente, se genera un error.</span></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;"><img src="img6.7.png" width="939" height="200" alt="mmm" /></span></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">Para solucionar el problema, y recuperar el tablespace, la idea es tratar de poner el tablespace en estado offline. Pero eso solo lo puedo hacer cuando la base de datos está abierta. Como accedo a poder abrir la BD exitosamente? Hago lo siguiente:</span></p>
<p><img src="img7.6.png" width="953" height="80" alt="MMM" /></p>
<p><span style="font-family: verdana, geneva, sans-serif;">Al poner el archivo de datos en modo OFFLINE, nos dejará abrir la base de datos.</span></p>
<p><img src="img8.7.png" width="958" height="70" alt="MM" /></p>
<p><span style="font-family: verdana, geneva, sans-serif;">Y es acá donde ponemos el tablespace en modo OFFLINE:</span></p>
<p><img src="img10.4.png" width="1069" height="103" alt="mmm" /></p>
<p><span style="font-family: verdana, geneva, sans-serif;">En este caso, como el único Data File del tablespace DATOS ya lo pusimos OFFLINE, automáticamente el tablepsace queda OFFLINE. Por eso saca el error de que el tablespace está ya OFFLINE. Pero normalmente un tablespace puede tener otros Data Files, y en este caso sí habria que ejecutar el OFFLINE del tablespace.</span></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">El tablespace que se va a recuperar se pone OFFLINE con el fin de que mientras hagamos el restore del tablespace, la base de datos esté disponible para otros usuarios.</span></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">A continuación, comencemos con la recuperación del tablespace. Primero el RESTORE del tablespace.</span></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;"><img src="img10.5.png" width="1069" height="196" alt="V" /></span></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">Luego, el RECOVER del tablespace. Se puede observar que utiliza unos ARCHIVELOGs para hacer el RECOVER.</span></p>
<p><img src="img11.5.png" width="1069" height="181" alt="MMMM" /></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">Luego de haber recuperado el tablespace, debemos poner el Data File correspondiente en modo ONLINE.</span></p>
<p><img src="img12.5.png" width="1047" height="89" alt="BB" /></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">Luego hagamos un SELECT a la tabla que habiamos creado en el tablespace, y ahi van a estar todos los datos. Se recuperó todo.</span></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;"><img src="img13.6.png" width="1001" height="265" alt="MMM" /></span></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">Video:</span></p>
<p style="text-align: justify;"><a href="https://www.youtube.com/watch?v=dNHiIQlV43k&amp;t=82s">Restore de Tablespace</a></p></div>
</div>
</div>
</article>
<div id="packageLicense" class="cc cc-by-sa">
<p><span>Obra publicada con</span> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Licencia Creative Commons Reconocimiento Compartir igual 4.0</a></p>
</div>
</section>
</div>
<div id='bottomPagination'>
<nav class="pagination noprt">
<a href="restore_base_de_datos_completa.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="restore_hasta_un_tiempo_t.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</nav>
</div>
</div>
<script type="text/javascript" src="_intef_js.js"></script></body></html>