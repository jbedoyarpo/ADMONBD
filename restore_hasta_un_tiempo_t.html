<!doctype html>
<html lang="es">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>RESTORE HASTA UN TIEMPO t | ADMINISTRACIÓN DE BASES DE DATOS </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta name="author" content="Jorge Iván Bedoya Restrepo" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-sa/4.0/" />
<meta name="generator" content="eXeLearning 2.5 - exelearning.net" />
<!--[if lt IE 9]><script type="text/javascript" src="exe_html5.js"></script><![endif]-->
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body class="exe-web-site" id="exe-node-54"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Saltar la navegación</a></p>
<header id="header" ><div id="headerContent">ADMINISTRACIÓN DE BASES DE DATOS</div></header>
<nav id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">ADMINISTRACIÓN DE BASES DE DATOS</a></li>
   <li><a href="rol_del_dba.html" class="no-ch">ROL DEL DBA</a></li>
   <li><a href="generalidades_de_oracle.html" class="daddy">GENERALIDADES DE ORACLE</a>
   <ul class="other-section">
      <li><a href="un_poco_de_historia.html" class="no-ch">UN POCO DE HISTORIA</a></li>
      <li><a href="pl__sql.html" class="no-ch">PL / SQL</a></li>
      <li><a href="ambientes_de_trabajo.html" class="daddy">AMBIENTES DE TRABAJO</a>
      <ul class="other-section">
         <li><a href="sql_plus.html" class="no-ch">SQL PLUS</a></li>
         <li><a href="sql_developer.html" class="no-ch">SQL DEVELOPER</a></li>
         <li><a href="otros_ambientes.html" class="no-ch">OTROS AMBIENTES</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="arquitectura_de_oracle.html" class="daddy">ARQUITECTURA DE ORACLE</a>
   <ul class="other-section">
      <li><a href="manejo_de_memoria.html" class="no-ch">MANEJO DE MEMORIA</a></li>
      <li><a href="manejo_de_procesos.html" class="no-ch">MANEJO DE PROCESOS</a></li>
      <li><a href="arquitectura_multitenant.html" class="no-ch">ARQUITECTURA MULTITENANT</a></li>
   </ul>
   </li>
   <li><a href="instrucciones_varias_de_oracle.html" class="no-ch">INSTRUCCIONES VARIAS DE ORACLE</a></li>
   <li><a href="vistas.html" class="daddy">VISTAS</a>
   <ul class="other-section">
      <li><a href="vistas_comunes.html" class="no-ch">VISTAS COMUNES</a></li>
      <li><a href="vistas_materializables.html" class="no-ch">VISTAS MATERIALIZABLES</a></li>
   </ul>
   </li>
   <li><a href="secuencias.html" class="no-ch">SECUENCIAS</a></li>
   <li><a href="migracin_de_datos.html" class="daddy">MIGRACIÓN DE DATOS</a>
   <ul class="other-section">
      <li><a href="insert_all.html" class="no-ch">INSERT ALL</a></li>
      <li><a href="insert_first__pivote.html" class="no-ch">INSERT FIRST - PIVOTE</a></li>
      <li><a href="merge.html" class="no-ch">MERGE</a></li>
   </ul>
   </li>
   <li><a href="manejo_de_ndices.html" class="no-ch">MANEJO DE ÍNDICES</a></li>
   <li><a href="manejo_de_usuarios.html" class="daddy">MANEJO DE USUARIOS</a>
   <ul class="other-section">
      <li><a href="usuarios_y_privilegios.html" class="no-ch">USUARIOS Y PRIVILEGIOS</a></li>
      <li><a href="roles.html" class="no-ch">ROLES</a></li>
      <li><a href="perfiles.html" class="no-ch">PERFILES</a></li>
   </ul>
   </li>
   <li><a href="diccionario_de_datos.html" class="daddy">DICCIONARIO DE DATOS</a>
   <ul class="other-section">
      <li><a href="ejercicio_completo.html" class="no-ch">EJERCICIO COMPLETO</a></li>
      <li><a href="consultas_tiles_para_el_dba.html" class="no-ch">CONSULTAS ÚTILES PARA EL DBA</a></li>
   </ul>
   </li>
   <li><a href="optimizacin_de_consultas.html" class="no-ch">OPTIMIZACIÓN DE CONSULTAS</a></li>
   <li><a href="buenas_prcticas_en_sql.html" class="no-ch">BUENAS PRÁCTICAS EN SQL</a></li>
   <li><a href="backups.html" class="daddy">BACKUPS</a>
   <ul class="other-section">
      <li><a href="undo_redologs_y_archivelogs.html" class="no-ch">UNDO, REDOLOGS y ARCHIVELOGS</a></li>
      <li><a href="rman.html" class="no-ch">RMAN</a></li>
      <li><a href="backup_completo.html" class="no-ch">BACKUP COMPLETO</a></li>
      <li><a href="backup_tablespaces.html" class="no-ch">BACKUP TABLESPACES</a></li>
      <li><a href="backup_controlfile.html" class="no-ch">BACKUP CONTROLFILE</a></li>
      <li><a href="backup_archivelog.html" class="no-ch">BACKUP ARCHIVELOG</a></li>
      <li><a href="backup_incremental.html" class="no-ch">BACKUP INCREMENTAL</a></li>
   </ul>
   </li>
   <li class="current-page-parent"><a href="restores.html" class="current-page-parent daddy">RESTORES</a>
   <ul>
      <li><a href="introduccion.html" class="no-ch">INTRODUCCION</a></li>
      <li><a href="restore_base_de_datos_completa.html" class="no-ch">RESTORE BASE DE DATOS COMPLETA</a></li>
      <li><a href="restore_de_tablespace.html" class="no-ch">RESTORE DE TABLESPACE</a></li>
      <li id="active"><a href="restore_hasta_un_tiempo_t.html" class="active no-ch">RESTORE HASTA UN TIEMPO t</a></li>
   </ul>
   </li>
   <li><a href="encriptacin_de_datos.html" class="no-ch">ENCRIPTACIÓN DE DATOS</a></li>
   <li><a href="flashback.html" class="no-ch">FLASHBACK</a></li>
   <li><a href="auditoria.html" class="no-ch">AUDITORIA</a></li>
   <li><a href="gestin_de_lobs.html" class="no-ch">GESTIÓN DE LOBs</a></li>
   <li><a href="tablas_particionadas.html" class="no-ch">TABLAS PARTICIONADAS</a></li>
   <li><a href="gestin_de_almacenamiento.html" class="no-ch">GESTIÓN DE ALMACENAMIENTO</a></li>
</ul>
</nav>
<div id='topPagination'>
<nav class="pagination noprt">
<a href="restore_de_tablespace.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="encriptacin_de_datos.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</nav>
</div>
<div id="main-wrapper">
<section id="main">
<header id="nodeDecoration"><h1 id="nodeTitle">RESTORE HASTA UN TIEMPO t</h1></header>
<article class="iDevice_wrapper textIdevice" id="id47">
<div class="iDevice emphasis0" >
<div id="ta47_109_2" class="block iDevice_content">
<div class="exe-text"><p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">A veces queremos restaurar la base de datos a un tiempo pasado específico, un tiempo t. Obviamente, al restaurar de esta manera, lo que se haya hecho en la base de datos depues del tiempo t, no quedará restaurado.</span></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">Miremos el siguiente SELECT. Con este SELECT miramos el primer SCN que ha habido en cada Redo Log File (FIRST_CHANGE#) y también fecha y hora del primer cambio hecho en cada Redo Log File.</span></p>
<p><img src="img0.12.png" width="1036" height="209" alt="mmm" /></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">Al darle ARCHIVE LOG LIST, podemos ver cual es el Redo Log File actual. En este caso, el de secuencia 21.</span></p>
<p><img src="img1.11.png" width="986" height="306" alt="b" /></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">Ahora, conectémonos con el usuario de trabajo y ejecutemos el siguiente SELECT. Vemos que la tabla contiene algunos datos.</span></p>
<p><img src="img2.11.png" width="1001" height="239" alt="mmm" /></p>
<p><span style="font-family: verdana, geneva, sans-serif;">Borremos todos los datos de la tabla que acabamos de consultar.</span></p>
<p><img src="img3.11.png" width="969" height="86" alt="BBB" /></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">Si volvemos a ejecutar el ARCHIVE LOG LIST, es posible que no hayan cambios porque estamos trabajando en un entorno monousuario, pero en la vida real s+i pudo haber cambiado. Por eso, vamos a forzar un SWITCH LOGFILE. Al volver a consultar, vemos que ya el Redo Log File en uso es el de secuencia 22.</span></p>
<p><img src="img4.11.png" width="1014" height="312" alt="mk" /></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">Ahora, a la tabla PRUEBA2 insertemosle una tupla. Recordar que dicha tabla no tiene tuplas actualmente, todas fueron borradas.</span></p>
<p><img src="img10.6.png" /></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">Supongamos que queremos restaurar hasta el punto anterior al DELETE de todas las tuplas de la tabla PRUEBA1, es decir, debe restaurar las filas borradas pero no la que acabamos de insertar.</span></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">Para hacer este tipo de restore, debo estar en modo MOUNT, no en modo OPEN.</span></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">Luego, para hacer la restauración, en RMAN hago lo siguiente. Si le hemos seguido el hilo al ejemplo, entenderemos que la tabla PRUEBA2, con sus dos tuplas, estaba en el Redo Log File de secuencia 21. Por eso, le decimos que restaure hasta ese punto del tiempo.</span></p>
<p><img src="img6.8.png" width="1069" height="90" alt="BBB" /></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">Luego abrimos la base de datos, pero lo debemos hacer con la cláusula RESETLOGS. Esta cláusula hace un "reset" de los Redo Log Files, volviendo inútiles todos los backups que hayamos hecho anteriormente. Por eso, despues de una apertura de la base de datos con esta cláusula, es imperativo hacer un backup completo, para no quedar desprotegido.</span></p>
<p><img src="img7.7.png" width="1069" height="75" alt="bbb" /></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">Otra manera de ver el efecto de RESETLOGS es ejecutando el SELECT sobre V$LOG. Podemos observar que la secuencia volvió a empezar en 1.</span></p>
<p><img src="img8.8.png" width="962" height="185" alt="mol" /></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">También se ve ejecutando lo siguiente:</span></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;"><img src="img11.6.png" /></span></p>
<p><span style="font-family: verdana, geneva, sans-serif;">Entonces, es urgente hacer un  BACKUP DATABASE en RMAN.</span></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;">Por último, miremos el contenido de la tabla PRUEBA2. Ahi estan los datos que se habian borrado, y que estaban antes de hacerle el DELETE. Acabamos de restaurar la base de datos a un punto anterior del tiempo.</span></p>
<p style="text-align: justify;"><span style="font-family: verdana, geneva, sans-serif;"><img src="img2.11.png" width="1001" height="239" alt="mmm" /></span></p></div>
</div>
</div>
</article>
<div id="packageLicense" class="cc cc-by-sa">
<p><span>Obra publicada con</span> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Licencia Creative Commons Reconocimiento Compartir igual 4.0</a></p>
</div>
</section>
</div>
<div id='bottomPagination'>
<nav class="pagination noprt">
<a href="restore_de_tablespace.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="encriptacin_de_datos.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</nav>
</div>
</div>
<script type="text/javascript" src="_intef_js.js"></script></body></html>